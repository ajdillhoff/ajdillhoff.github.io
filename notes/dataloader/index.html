<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academia 4.3.1">
  <meta name="theme-name" content="academia-hugo"/>

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Alex Dillhoff">

  
  
  
    
  
  <meta name="description" content="Loading Data for ML Applications In this notebook, we will implement code to load data for ML applications. Following the approach used by PyTorch, we will implement a Dataset class and a DataLoader class. The Dataset class will be used to load the data and the DataLoader class will be used to iterate over the data in batches.
We will test it on a simple image dataset.
The Dataset Class First, we need some way of representing how each individual item will be pre-processed as the dataloader iterates over the data.">

  
  <link rel="alternate" hreflang="en-us" href="https://ajdillhoff.github.io/notes/dataloader/">

  


  

  
  
  
  <meta name="theme-color" content="#fc6f5c">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.css" integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ==" crossorigin="anonymous">
    

    

  

  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Open+Sans|Roboto+Mono&display=swap">
  

  
  
  
  <link rel="stylesheet" href="/css/academia.min.b246554d075350d61b44c126dfbcbe05.css">

  
    
    
    
    
      
    
    
    
    <link rel="stylesheet" href="/css/academia.a75a9b8a9a725a2157c0c5b929a3d18b.css">
  

  
  
  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-123456-78', 'auto');
      
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  
  

  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://ajdillhoff.github.io/notes/dataloader/">

  
  
  
  
    
    
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Alex Dillhoff">
  <meta property="og:url" content="https://ajdillhoff.github.io/notes/dataloader/">
  <meta property="og:title" content="Example: Writing a Data Loader in Python | Alex Dillhoff">
  <meta property="og:description" content="Loading Data for ML Applications In this notebook, we will implement code to load data for ML applications. Following the approach used by PyTorch, we will implement a Dataset class and a DataLoader class. The Dataset class will be used to load the data and the DataLoader class will be used to iterate over the data in batches.
We will test it on a simple image dataset.
The Dataset Class First, we need some way of representing how each individual item will be pre-processed as the dataloader iterates over the data."><meta property="og:image" content="https://ajdillhoff.github.io/img/icon-192.png">
  <meta property="twitter:image" content="https://ajdillhoff.github.io/img/icon-192.png"><meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2023-09-04T00:00:00-05:00">
  
  <meta property="article:modified_time" content="2023-09-04T00:00:00-05:00">
  

  


  





  <title>Example: Writing a Data Loader in Python | Alex Dillhoff</title>

  <script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true
    },
    svg: {
      fontCache: 'global'
    }
  };
</script>
<script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>



</head>


<body id="top" data-spy="scroll" data-target="#TableOfContents" data-offset="71" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">Alex Dillhoff</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation"><span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">
      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/notes/"><span>Brain Dump</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/courses/"><span>Courses</span></a>
        </li>

        
        

      

        

        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>
    </div>
  </div>
</nav>


  <article class="article py-5" itemscope itemtype="http://schema.org/Article">

  












    

    
    
    
    <div class="article-container py-3">
      <h1 itemprop="name">Example: Writing a Data Loader in Python</h1>

      

      
      



<meta content="2023-09-04 00:00:00 -0500 CDT" itemprop="datePublished">
<meta content="2023-09-04 00:00:00 -0500 CDT" itemprop="dateModified">

<div class="article-metadata">

  
  
  
  
  <div>
    



  <span itemprop="author name" itemtype="http://schema.org/Person"><a href="/authors/alex-dillhoff/">Alex Dillhoff</a></span>

  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    <time>Sep 4, 2023</time>
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    6 min read
  </span>
  

  
  
  
  
  

  
  

  
    
<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://ajdillhoff.github.io/notes/dataloader/&amp;text=Example:%20Writing%20a%20Data%20Loader%20in%20Python" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://ajdillhoff.github.io/notes/dataloader/&amp;t=Example:%20Writing%20a%20Data%20Loader%20in%20Python" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook-f"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Example:%20Writing%20a%20Data%20Loader%20in%20Python&amp;body=https://ajdillhoff.github.io/notes/dataloader/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://ajdillhoff.github.io/notes/dataloader/&amp;title=Example:%20Writing%20a%20Data%20Loader%20in%20Python" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Example:%20Writing%20a%20Data%20Loader%20in%20Python%20https://ajdillhoff.github.io/notes/dataloader/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://ajdillhoff.github.io/notes/dataloader/&amp;title=Example:%20Writing%20a%20Data%20Loader%20in%20Python" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>


  

</div>

      














      
      
    </div>
  </div>
</div>

  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      <a target="_blank" href="https://colab.research.google.com/github/ajdillhoff/python-examples/blob/main/examples/dataloader.ipynb">
  <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/>
</a>
<h1 id="loading-data-for-ml-applications">Loading Data for ML Applications</h1>
<p>In this notebook, we will implement code to load data for ML applications. Following the approach used by <code>PyTorch</code>, we will implement a <code>Dataset</code> class and a <code>DataLoader</code> class. The <code>Dataset</code> class will be used to load the data and the <code>DataLoader</code> class will be used to iterate over the data in batches.</p>
<p>We will test it on a simple image dataset.</p>
<h2 id="the-dataset-class">The <code>Dataset</code> Class</h2>
<p>First, we need some way of representing how each individual item will be pre-processed as the dataloader iterates over the data. We will do this by creating a <code>Dataset</code> class. Since this class represents multiple items in our dataset, we will need to define the following special methods:</p>
<ul>
<li><code>__len__</code>: returns the length of the dataset</li>
<li><code>__getitem__</code>: returns the item at a given index</li>
</ul>
<h2 id="the-intel-image-classification-dataset">The Intel Image Classification Dataset</h2>
<p>We will use the <a href="https://www.kaggle.com/datasets/puneet6060/intel-image-classification" target="_blank" rel="noopener noreferrer">Intel Image Classification Dataset</a> from Kaggle. This dataset contains images of natural scenes around the world. The dataset contains 25,000 images of size 150x150 distributed under 6 categories. The dataset is divided into a training set and a test set. The training set contains 14k images. The images are organized under folder representing each category. When initializing our dataset, it should iterate through the folders to enumerate all the images and their corresponding labels.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">IntelDataset</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, data_path):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>data_path <span style="color:#f92672">=</span> data_path
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>classes, self<span style="color:#f92672">.</span>class_to_idx <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_find_classes(self<span style="color:#f92672">.</span>data_path)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>samples <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_make_dataset(self<span style="color:#f92672">.</span>data_path, self<span style="color:#f92672">.</span>class_to_idx)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __len__(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> len(self<span style="color:#f92672">.</span>samples)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __getitem__(self, idx):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">NotImplementedError</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_find_classes</span>(self, path):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Summarized from torchvision.datasets.ImageFolder&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        classes <span style="color:#f92672">=</span> [d<span style="color:#f92672">.</span>name <span style="color:#66d9ef">for</span> d <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>scandir(path) <span style="color:#66d9ef">if</span> d<span style="color:#f92672">.</span>is_dir()]
</span></span><span style="display:flex;"><span>        classes<span style="color:#f92672">.</span>sort()
</span></span><span style="display:flex;"><span>        class_to_idx <span style="color:#f92672">=</span> {cls_name: i <span style="color:#66d9ef">for</span> i, cls_name <span style="color:#f92672">in</span> enumerate(classes)}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> classes, class_to_idx
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_make_dataset</span>(self, dir, class_to_idx):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Summarized from torchvision.datasets.ImageFolder&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        images <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>        dir <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>expanduser(dir)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> target <span style="color:#f92672">in</span> sorted(os<span style="color:#f92672">.</span>listdir(dir)):
</span></span><span style="display:flex;"><span>            d <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(dir, target)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>isdir(d):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> root, _, fnames <span style="color:#f92672">in</span> sorted(os<span style="color:#f92672">.</span>walk(d)):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> fname <span style="color:#f92672">in</span> sorted(fnames):
</span></span><span style="display:flex;"><span>                    path <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(root, fname)
</span></span><span style="display:flex;"><span>                    item <span style="color:#f92672">=</span> (path, class_to_idx[target])
</span></span><span style="display:flex;"><span>                    images<span style="color:#f92672">.</span>append(item)
</span></span><span style="display:flex;"><span>                    
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> images
</span></span></code></pre></div><p>Here is the first iteration of our dataset. Let&rsquo;s test it on the Intel Image Classification dataset available here: <a href="https://www.kaggle.com/datasets/puneet6060/intel-image-classification" target="_blank" rel="noopener noreferrer">https://www.kaggle.com/datasets/puneet6060/intel-image-classification</a>.</p>
<p>We will use the training samples to test our <code>Dataset</code> class. There are 14,000 images in the training set over 6 categories. Each category is contained in its own subfolder.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>dataset <span style="color:#f92672">=</span> IntelDataset(data_path<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;data/seg_train&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(dataset<span style="color:#f92672">.</span>classes)
</span></span><span style="display:flex;"><span>print(dataset<span style="color:#f92672">.</span>class_to_idx)
</span></span><span style="display:flex;"><span>print(len(dataset))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Sample the first 5 items</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5</span>):
</span></span><span style="display:flex;"><span>    print(dataset<span style="color:#f92672">.</span>samples[i])
</span></span></code></pre></div><pre><code>['buildings', 'forest', 'glacier', 'mountain', 'sea', 'street']
{'buildings': 0, 'forest': 1, 'glacier': 2, 'mountain': 3, 'sea': 4, 'street': 5}
14034
('data/seg_train/buildings/0.jpg', 0)
('data/seg_train/buildings/10006.jpg', 0)
('data/seg_train/buildings/1001.jpg', 0)
('data/seg_train/buildings/10014.jpg', 0)
('data/seg_train/buildings/10018.jpg', 0)
</code></pre>
<h3 id="loading-the-images">Loading the Images</h3>
<p>Now that we can successfully initialize the dataset, we can implement <code>__getitem__</code> to load the actual image and return a tuple of the image and its label. We will use the <code>PIL</code> library to load the image and convert it to a <code>numpy</code> array.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> PIL <span style="color:#f92672">import</span> Image
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">IntelDataset</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, data_path):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>data_path <span style="color:#f92672">=</span> data_path
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>classes, self<span style="color:#f92672">.</span>class_to_idx <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_find_classes(self<span style="color:#f92672">.</span>data_path)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>samples <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_make_dataset(self<span style="color:#f92672">.</span>data_path, self<span style="color:#f92672">.</span>class_to_idx)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __len__(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> len(self<span style="color:#f92672">.</span>samples)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __getitem__(self, idx):
</span></span><span style="display:flex;"><span>        path, target <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>samples[idx]
</span></span><span style="display:flex;"><span>        image <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>open(path)<span style="color:#f92672">.</span>convert(<span style="color:#e6db74">&#39;RGB&#39;</span>)
</span></span><span style="display:flex;"><span>        image <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(image)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> image, target
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_find_classes</span>(self, path):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Summarized from torchvision.datasets.ImageFolder&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        classes <span style="color:#f92672">=</span> [d<span style="color:#f92672">.</span>name <span style="color:#66d9ef">for</span> d <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>scandir(path) <span style="color:#66d9ef">if</span> d<span style="color:#f92672">.</span>is_dir()]
</span></span><span style="display:flex;"><span>        classes<span style="color:#f92672">.</span>sort()
</span></span><span style="display:flex;"><span>        class_to_idx <span style="color:#f92672">=</span> {cls_name: i <span style="color:#66d9ef">for</span> i, cls_name <span style="color:#f92672">in</span> enumerate(classes)}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> classes, class_to_idx
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_make_dataset</span>(self, dir, class_to_idx):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Summarized from torchvision.datasets.ImageFolder&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        images <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>        dir <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>expanduser(dir)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> target <span style="color:#f92672">in</span> sorted(os<span style="color:#f92672">.</span>listdir(dir)):
</span></span><span style="display:flex;"><span>            d <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(dir, target)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>isdir(d):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> root, _, fnames <span style="color:#f92672">in</span> sorted(os<span style="color:#f92672">.</span>walk(d)):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> fname <span style="color:#f92672">in</span> sorted(fnames):
</span></span><span style="display:flex;"><span>                    path <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(root, fname)
</span></span><span style="display:flex;"><span>                    item <span style="color:#f92672">=</span> (path, class_to_idx[target])
</span></span><span style="display:flex;"><span>                    images<span style="color:#f92672">.</span>append(item)
</span></span><span style="display:flex;"><span>                    
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> images
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Sample 9 random images and display them with their labels</span>
</span></span><span style="display:flex;"><span>dataset <span style="color:#f92672">=</span> IntelDataset(data_path<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;data/seg_train&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>fig, axes <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">3</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>):
</span></span><span style="display:flex;"><span>        idx <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randint(len(dataset))
</span></span><span style="display:flex;"><span>        image, target <span style="color:#f92672">=</span> dataset[idx]
</span></span><span style="display:flex;"><span>        axes[i, j]<span style="color:#f92672">.</span>imshow(image)
</span></span><span style="display:flex;"><span>        axes[i, j]<span style="color:#f92672">.</span>set_title(dataset<span style="color:#f92672">.</span>classes[target])
</span></span><span style="display:flex;"><span>        axes[i, j]<span style="color:#f92672">.</span>axis(<span style="color:#e6db74">&#39;off&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p>
  <img src="dataloader_files/dataloader_5_0.png" alt="png">
</p>
<h2 id="the-dataloader-class">The <code>DataLoader</code> Class</h2>
<p>Now that we have a <code>Dataset</code> to manage loading each individual item, we need to create a <code>DataLoader</code> that is responsible for iterating over the dataset in batches.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DataLoader</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, dataset, batch_size, shuffle<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>dataset <span style="color:#f92672">=</span> dataset
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>batch_size <span style="color:#f92672">=</span> batch_size
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>shuffle <span style="color:#f92672">=</span> shuffle
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __len__(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> len(self<span style="color:#f92672">.</span>dataset) <span style="color:#f92672">//</span> self<span style="color:#f92672">.</span>batch_size
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __iter__(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>shuffle:
</span></span><span style="display:flex;"><span>            indices <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>permutation(len(self<span style="color:#f92672">.</span>dataset))
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            indices <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(len(self<span style="color:#f92672">.</span>dataset))
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(self)):
</span></span><span style="display:flex;"><span>            batch_indices <span style="color:#f92672">=</span> indices[i<span style="color:#f92672">*</span>self<span style="color:#f92672">.</span>batch_size:(i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>self<span style="color:#f92672">.</span>batch_size]
</span></span><span style="display:flex;"><span>            batch <span style="color:#f92672">=</span> [self<span style="color:#f92672">.</span>dataset[idx] <span style="color:#66d9ef">for</span> idx <span style="color:#f92672">in</span> batch_indices]
</span></span><span style="display:flex;"><span>            images, targets <span style="color:#f92672">=</span> zip(<span style="color:#f92672">*</span>batch)
</span></span><span style="display:flex;"><span>            images <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>stack(images, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>            targets <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>stack(targets, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">yield</span> images, targets
</span></span></code></pre></div><p>In this example, the <code>__iter__</code> uses Python generators to yield a batch of data instead of overriding the <code>__next__</code> method.</p>
<p>Let&rsquo;s test this with our dataset.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>dataset <span style="color:#f92672">=</span> IntelDataset(data_path<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;data/seg_train&#39;</span>)
</span></span><span style="display:flex;"><span>dataloader <span style="color:#f92672">=</span> DataLoader(dataset, batch_size<span style="color:#f92672">=</span><span style="color:#ae81ff">32</span>, shuffle<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Print the first 5 batches</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i, (images, targets) <span style="color:#f92672">in</span> enumerate(dataloader):
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;Batch </span><span style="color:#e6db74">{</span>i<span style="color:#e6db74">}</span><span style="color:#e6db74"> images shape: </span><span style="color:#e6db74">{</span>images<span style="color:#f92672">.</span>shape<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;Batch </span><span style="color:#e6db74">{</span>i<span style="color:#e6db74">}</span><span style="color:#e6db74"> targets shape: </span><span style="color:#e6db74">{</span>targets<span style="color:#f92672">.</span>shape<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> i <span style="color:#f92672">==</span> <span style="color:#ae81ff">5</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>
</span></span></code></pre></div><pre><code>Batch 0 images shape: (32, 150, 150, 3)
Batch 0 targets shape: (32,)
Batch 1 images shape: (32, 150, 150, 3)
Batch 1 targets shape: (32,)
Batch 2 images shape: (32, 150, 150, 3)
Batch 2 targets shape: (32,)
Batch 3 images shape: (32, 150, 150, 3)
Batch 3 targets shape: (32,)
Batch 4 images shape: (32, 150, 150, 3)
Batch 4 targets shape: (32,)
Batch 5 images shape: (32, 150, 150, 3)
Batch 5 targets shape: (32,)
</code></pre>
<h2 id="cleaning-the-data">Cleaning the Data</h2>
<p>Our data loader failed because there are some images that are not $150 \times 150$. We need to figure out exactly what to do with those images. We can either remove them or resize them so that they are all the same size. We will resize them to $150 \times 150$. This will be easiest to do in the <code>__getitem__</code> method of our <code>Dataset</code> class.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> PIL <span style="color:#f92672">import</span> Image
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">IntelDataset</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, data_path):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>data_path <span style="color:#f92672">=</span> data_path
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>classes, self<span style="color:#f92672">.</span>class_to_idx <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_find_classes(self<span style="color:#f92672">.</span>data_path)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>samples <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_make_dataset(self<span style="color:#f92672">.</span>data_path, self<span style="color:#f92672">.</span>class_to_idx)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __len__(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> len(self<span style="color:#f92672">.</span>samples)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __getitem__(self, idx):
</span></span><span style="display:flex;"><span>        path, target <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>samples[idx]
</span></span><span style="display:flex;"><span>        image <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>open(path)<span style="color:#f92672">.</span>convert(<span style="color:#e6db74">&#39;RGB&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Resize if the image is not 150x150</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> image<span style="color:#f92672">.</span>size <span style="color:#f92672">!=</span> (<span style="color:#ae81ff">150</span>, <span style="color:#ae81ff">150</span>):
</span></span><span style="display:flex;"><span>            image <span style="color:#f92672">=</span> image<span style="color:#f92672">.</span>resize((<span style="color:#ae81ff">150</span>, <span style="color:#ae81ff">150</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        image <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(image)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> image, target
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_find_classes</span>(self, path):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Summarized from torchvision.datasets.ImageFolder&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        classes <span style="color:#f92672">=</span> [d<span style="color:#f92672">.</span>name <span style="color:#66d9ef">for</span> d <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>scandir(path) <span style="color:#66d9ef">if</span> d<span style="color:#f92672">.</span>is_dir()]
</span></span><span style="display:flex;"><span>        classes<span style="color:#f92672">.</span>sort()
</span></span><span style="display:flex;"><span>        class_to_idx <span style="color:#f92672">=</span> {cls_name: i <span style="color:#66d9ef">for</span> i, cls_name <span style="color:#f92672">in</span> enumerate(classes)}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> classes, class_to_idx
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_make_dataset</span>(self, dir, class_to_idx):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Summarized from torchvision.datasets.ImageFolder&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        images <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>        dir <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>expanduser(dir)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> target <span style="color:#f92672">in</span> sorted(os<span style="color:#f92672">.</span>listdir(dir)):
</span></span><span style="display:flex;"><span>            d <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(dir, target)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>isdir(d):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> root, _, fnames <span style="color:#f92672">in</span> sorted(os<span style="color:#f92672">.</span>walk(d)):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> fname <span style="color:#f92672">in</span> sorted(fnames):
</span></span><span style="display:flex;"><span>                    path <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(root, fname)
</span></span><span style="display:flex;"><span>                    item <span style="color:#f92672">=</span> (path, class_to_idx[target])
</span></span><span style="display:flex;"><span>                    images<span style="color:#f92672">.</span>append(item)
</span></span><span style="display:flex;"><span>                    
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> images
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>dataset <span style="color:#f92672">=</span> IntelDataset(data_path<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;data/seg_train&#39;</span>)
</span></span><span style="display:flex;"><span>dataloader <span style="color:#f92672">=</span> DataLoader(dataset, batch_size<span style="color:#f92672">=</span><span style="color:#ae81ff">32</span>, shuffle<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Verify that our fix works!</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Only print the first 5 batches</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i, (images, targets) <span style="color:#f92672">in</span> enumerate(dataloader):
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;Batch </span><span style="color:#e6db74">{</span>i<span style="color:#e6db74">}</span><span style="color:#e6db74"> images shape: </span><span style="color:#e6db74">{</span>images<span style="color:#f92672">.</span>shape<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;Batch </span><span style="color:#e6db74">{</span>i<span style="color:#e6db74">}</span><span style="color:#e6db74"> targets shape: </span><span style="color:#e6db74">{</span>targets<span style="color:#f92672">.</span>shape<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> i <span style="color:#f92672">==</span> <span style="color:#ae81ff">5</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>
</span></span></code></pre></div><pre><code>Batch 0 images shape: (32, 150, 150, 3)
Batch 0 targets shape: (32,)
Batch 1 images shape: (32, 150, 150, 3)
Batch 1 targets shape: (32,)
Batch 2 images shape: (32, 150, 150, 3)
Batch 2 targets shape: (32,)
Batch 3 images shape: (32, 150, 150, 3)
Batch 3 targets shape: (32,)
Batch 4 images shape: (32, 150, 150, 3)
Batch 4 targets shape: (32,)
Batch 5 images shape: (32, 150, 150, 3)
Batch 5 targets shape: (32,)
</code></pre>

    </div>

    

<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/python/">python</a>
  
  <a class="badge badge-light" href="/tags/examples/">examples</a>
  
</div>



    
      








  
  
    
  
  





  
  
  
    
  
  
  <div class="media author-card" itemscope itemtype="http://schema.org/Person">
    

    <div class="media-body">
      <h5 class="card-title" itemprop="name"><a href="https://ajdillhoff.github.io/">Alex Dillhoff</a></h5>
      <h6 class="card-subtitle">Senior Lecturer</h6>
      <p class="card-text" itemprop="description">&quot;If we understood the world, we would realize that there is a logic of harmony underlying its manifold apparent dissonances.&quot; - Jean Sibelius</p>
      <ul class="network-icon" aria-hidden="true">
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="/#contact" >
              <i class="fas fa-envelope"></i>
            </a>
          </li>
        
          
          
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://scholar.google.co.uk/citations?user=UlLhCtkAAAAJ" target="_blank" rel="noopener">
              <i class="ai ai-google-scholar"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://github.com/ajdillhoff" target="_blank" rel="noopener">
              <i class="fab fa-github"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>



      
      
      <div class="article-widget">
        <div class="hr-light"></div>
        <h3>Related</h3>
        <ul>
          
          <li><a href="/notes/oop/">Object-Oriented Programming with Python</a></li>
          
          <li><a href="/notes/file_io/">Python File I/O</a></li>
          
          <li><a href="/notes/functions/">Python Functions</a></li>
          
          <li><a href="/notes/list_comprehensions/">Python List Comprehensions</a></li>
          
          <li><a href="/notes/control_flow_in_python/">Control Flow in Python</a></li>
          
        </ul>
      </div>
      
    

    

    

  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
      

      
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.js" integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log==" crossorigin="anonymous"></script>
    

    
    
    
    <script id="dsq-count-scr" src="//themefisher-template.disqus.com/count.js" async></script>
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    

    
    

    

    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    
    <script src="/js/academia.min.5328943609f83580d0f13f6d5b5f2587.js"></script>

    






  
  <div class="container">
    <footer class="site-footer">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-6 mb-4 mb-md-0">
        
        <p class="mb-0">
          Copyright  2024 &middot; 
          Powered by
          <a href="https://gethugothemes.com" target="_blank" rel="noopener">Gethugothemes</a>
        </p>
      </div>
      <div class="col-md-6">
        <ul class="list-inline network-icon text-right mb-0">
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="list-inline-item">
            <a href="https://github.com/ajdillhoff" target="_blank" rel="noopener" title="My GitHub"><i class="fab fa-github" aria-hidden="true"></i></a>
          </li>
          
          
          
          
          
          
          
          
          
          
          <li class="list-inline-item">
            <a href="https://github.com/ajdillhoff" target="_blank" rel="noopener" title="My GitHub"><i class="ai ai-google-scholar" aria-hidden="true"></i></a>
          </li>
          
        </ul>
      </div>
    </div>
  </div>
</footer>
  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
